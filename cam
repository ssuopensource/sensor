import RPi.GPIO as GPIO
import picamera
import time
import datetime

#define record():
    camera = picamera.Picamera()
    camera.resolution = (1280, 720)
    now = datetime.datetime.now()
    filename = now.strftime('%Y-%m-%d %H:%M:%S')
    camera.start_recording(output = filename + '.h264')
    camera.wait_recording(10)
    camera.stop_recording()

#사용하는 GPIO 핀의 값으로 변경하여 사용
GPIOIN = 1
GPIOOUT = 2

GPIO.setmode(GPIO.BCM)

GPIO.setup(GPIOIN, GPIO.IN)
GPIO.setup(GPIOOUT, GPIO.OUT)

while True:
    state = GPIO.input(GPIOIN) #움직임이 감지되었는지 여부를 받아
    
    if (state == True):
        print("Motion detected")
        record()
    else:
        print("Motion not detected") #움직임 여부를 출력
    
    GPIO.output(GPIOOUT, state)
    time.sleep(0.5)
    
GPIO.cleanup()
print("Motion detection ended")
